<!DOCTYPE HTML>
<html>

<head>
	<link rel="bookmark"  type="image/x-icon"  href="/img/favicon.png"/>
	<link rel="shortcut icon" href="/img/favicon.png">
	<meta name="baidu-site-verification" content="code-KLcpk3wnwR" />
	
			<title>趙天一ლ(ﾟдﾟლ)You know、You don’t know</title>
<meta charset="utf-8" />
<meta
  name="viewport"
  content="width=device-width, initial-scale=1, user-scalable=no"
/>
<link rel="stylesheet" href="/css/mic_main.css" />
<link rel="stylesheet" href="/css/dropdownMenu.css" />
<!-- <script src="/js/live2d/autoload.js"></script> -->

<meta name="keywords" content="Zssaer JavaWeb TIANYI ZHAO" />

<noscript>
  <link rel="stylesheet" href="/css/noscript.css" />
</noscript>
<style type="text/css">
  /* body{
    background: url('https://zssaer.oss-cn-chengdu.aliyuncs.com/wallhaven-r7r551.jpg?x-oss-process=style/wallpaper') center 0 no-repeat;
    content: " ";
    position: fixed;
  } */
  body:before {
    content: " ";
    position: fixed;
    top: 0;
    background: url('https://zssaer.oss-cn-chengdu.aliyuncs.com/wallhaven-r7r551.jpg?x-oss-process=style/wallpaper') center 0 no-repeat;

    right: 0;
    bottom: 0;
    left: 0;
    background-size: cover;
  }
</style>

			    

    <script src="https://zssaer.oss-cn-chengdu.aliyuncs.com/jquery.min.js"></script>
    <script src="https://zssaer.oss-cn-chengdu.aliyuncs.com/jquery.scrollex.min.js"></script>
    <script src="https://zssaer.oss-cn-chengdu.aliyuncs.com/jquery.scrolly.min.js"></script>
    <script src="https://zssaer.oss-cn-chengdu.aliyuncs.com/skel.min.js"></script>
    <script src="https://zssaer.oss-cn-chengdu.aliyuncs.com/util.js"></script>
    <script src="https://zssaer.oss-cn-chengdu.aliyuncs.com/main.js"></script>
	
<meta name="generator" content="Hexo 5.4.0"></head>
    
		<!-- Layouts -->


<!--  代码渲染  -->
<script src="/js/prism.js"></script>
<link rel="stylesheet" href="/css/prism_coy.css" />
<link rel="stylesheet" href="/css/typo.css" />
<!-- 文章页 -->
<body
  class=""
  data-prismjs-copy="复制"
  data-prismjs-copy-error="请按Ctrl+C手动复制"
  data-prismjs-copy-success="复制成功!"
>
  <div class="mask-border"></div>
  <!-- Wrapper 外包 s-->
  <div id="wrapper" class="fade-in">
    <!-- Intro 头部显示 s -->
    <!-- Intro 头部显示 e -->
    <!-- Header 头部logo start -->
    <header id="header">
    <a href="/" class="logo">Refrain</a>
</header>
    <!-- Nav 导航条 start -->
    <nav id="nav" class="special" >
            <ul class="menu links" >
			<!-- Homepage  主页  --> 
			<li >
	            <a href="/" rel="nofollow">Home</a>
	        </li>
			<!-- categories_name  分类   --> 
	        
	        <li class="active">
	            <a href="#s1">Categories</a>
	                    <ul class="submenu">
	                        <li>
	                        <a class="category-link" href="/categories/C/">C++</a></li><li><a class="category-link" href="/categories/JAVA/">JAVA</a></li><li><a class="category-link" href="/categories/Python/">Python</a></li><li><a class="category-link" href="/categories/%E5%85%B6%E4%BB%96/">其他</a></li><li><a class="category-link" href="/categories/%E5%89%8D%E7%AB%AF/">前端</a></li><li><a class="category-link" href="/categories/%E5%90%8E%E7%AB%AF/">后端</a></li><li><a class="category-link" href="/categories/%E6%9D%82%E8%B0%88/">杂谈</a></li><li><a class="category-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a>
	                    </ul>
	        </li>
	        
	        <!-- archives  归档   --> 
	        
	        
		        <!-- Pages 自定义   -->
		        
		        <li>
		            <a href="/about/" title="AboutMe">
		                AboutMe
		            </a>
		        </li>
		        
		        <li>
		            <a href="/gallery/" title="Wallpaper">
		                Wallpaper
		            </a>
		        </li>
		        
		        <li>
		            <a href="/bangumis/" title="Bangumis">
		                Bangumis
		            </a>
		        </li>
		        
						<li class="active">
							<a href="#s1">Other</a>
											<ul class="submenu">
													<li>
													<a class="category-link" href="/another/billiard.html">台球模拟V1.0</a>
												</li>
											</ul>
						</li>

            </ul>
            <!-- icons 图标   -->
			<ul class="icons">
                    
                    <li>
                        <a title="github" href="https://github.com/Zssaer" target="_blank" rel="noopener">
                            <i class="icon fa fa-github"></i>
                        </a>
                    </li>
                    
                    <li>
                        <a title="git" href="https://gitee.com/Zssaer01" target="_blank" rel="noopener">
                            <i class="icon fa fa-git"></i>
                        </a>
                    </li>
                    
			</ul>
</nav>
    <aside id="toc_menu"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#JWT%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E6%95%99%E7%A8%8B"><span class="toc-number">1.</span> <span class="toc-text">JWT快速上手教程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8%E5%A4%84"><span class="toc-number">1.1.</span> <span class="toc-text">用处</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E7%BB%93%E6%9E%84"><span class="toc-number">1.2.</span> <span class="toc-text">基本结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%B4%E9%83%A8%EF%BC%88header%EF%BC%89"><span class="toc-number">1.2.1.</span> <span class="toc-text">头部（header）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%BD%E8%8D%B7%EF%BC%88payload%EF%BC%89"><span class="toc-number">1.2.2.</span> <span class="toc-text">载荷（payload）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%BE%E5%90%8D%EF%BC%88signature%EF%BC%89"><span class="toc-number">1.2.3.</span> <span class="toc-text">签名（signature）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A8JAVA%E4%B8%AD%E4%BD%BF%E7%94%A8"><span class="toc-number">1.3.</span> <span class="toc-text">在JAVA中使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8JJWT%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAJSON"><span class="toc-number">1.3.1.</span> <span class="toc-text">使用JJWT创建一个JSON</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8JJWT%E8%A7%A3%E5%AF%86JWT"><span class="toc-number">1.3.2.</span> <span class="toc-text">使用JJWT解密JWT</span></a></li></ol></li></ol></li></ol></aside>
    <div id="main">
      
      <div
        class="post_page_title_img"
        style="
          height: 25rem;
          background-image: url(https://zssaer.oss-cn-chengdu.aliyuncs.com/wallhaven-wq35yp.jpg?x-oss-process=style/wallpaper);
          background-position: center;
          background-repeat: no-repeat;
          background-size: cover;
          -moz-background-size: cover;
          overflow: hidden;
        "
      >
        <a href="#" style="padding: 4rem 4rem 2rem 4rem"
          ><h2 id="page-title">JWT快速上手教程</h2></a
        >
      </div>
      
      <button id="toc_button" onclick="openTocSidebar()">文章导航</button>
      <!-- <div id="content_toc">
                <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#JWT%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E6%95%99%E7%A8%8B"><span class="toc-number">1.</span> <span class="toc-text">JWT快速上手教程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8%E5%A4%84"><span class="toc-number">1.1.</span> <span class="toc-text">用处</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E7%BB%93%E6%9E%84"><span class="toc-number">1.2.</span> <span class="toc-text">基本结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%B4%E9%83%A8%EF%BC%88header%EF%BC%89"><span class="toc-number">1.2.1.</span> <span class="toc-text">头部（header）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%BD%E8%8D%B7%EF%BC%88payload%EF%BC%89"><span class="toc-number">1.2.2.</span> <span class="toc-text">载荷（payload）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%BE%E5%90%8D%EF%BC%88signature%EF%BC%89"><span class="toc-number">1.2.3.</span> <span class="toc-text">签名（signature）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A8JAVA%E4%B8%AD%E4%BD%BF%E7%94%A8"><span class="toc-number">1.3.</span> <span class="toc-text">在JAVA中使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8JJWT%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAJSON"><span class="toc-number">1.3.1.</span> <span class="toc-text">使用JJWT创建一个JSON</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8JJWT%E8%A7%A3%E5%AF%86JWT"><span class="toc-number">1.3.2.</span> <span class="toc-text">使用JJWT解密JWT</span></a></li></ol></li></ol></li></ol>
            </div>     -->

      <!-- Post -->
      <div class="typo" style="padding: 3rem"><h1 id="JWT快速上手教程"><a href="#JWT快速上手教程" class="headerlink" title="JWT快速上手教程"></a>JWT快速上手教程</h1><p>JWT全程为JSON Web Token，顾名思义就是以Json形式的存在的Web密令。</p>
<p>由于是一串Json文本，所以它十分便捷，规范也非常轻巧。这个规范允许我们使用JWT在用户和服务器之间传递安全可靠的信息。</p>
<h2 id="用处"><a href="#用处" class="headerlink" title="用处"></a>用处</h2><p>大伙都知道在Web中，拥有Session和Cookie、Loacl Storage等存储方式。但是他们都有一个非常致命的缺点：自身不能自动实现保密。</p>
<p>Session的机制导致或许可以进行达到一些安全性的范畴，Cookie则完全暴露，经常被黑客滥用，导致一些浏览器在一些网站上默认关闭Cookie功能，而Loacl Storage不仅没有安全性，还会对造成无用数据堆积。</p>
<p>JWT本身由各个算法而来，而它又集成了Cookie过期时间的功能，所以被广泛使用于传输保密内容中。</p>
<p>近年来，前后端分离的流行，自然，前后端的通讯是需要解决的问题之一，特别是在身份认证方面。</p>
<p>传统的JAVA身份认证框架，如Spring Security、Shiro等，都是采用的Session进行身份认证的，通过内部的缓存存储服务器存储Session。所以前后端Session认证则十分麻烦，使用JWT实现无状态的认证则是主流。</p>
<p>JWT身份认证就像 人的身份证一样，只要携带就代表是本人一样。</p>
<h2 id="基本结构"><a href="#基本结构" class="headerlink" title="基本结构"></a>基本结构</h2><pre class="line-numbers language-none"><code class="language-none">eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJ1c2VyIiwiZXhwIjoxNjM3Mjg5MTY0fQ.yl-5VYvv2yjD906rWvf6GyACjZLeQLHaG-ACwIBFs3FUkbZelbNbM0qy71AlJIbfMiLlxSkvhSGenSZz0R5xww<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>上述就是一个标准的JWT。</p>
<p>JWT实际上就是一个字符串，它由三部分组成：头部（header）、载荷（payload）与签名（signature）。</p>
<p><img src="https://zssaer.oss-cn-chengdu.aliyuncs.com/aHR0cHM6Ly9pLmxvbGkubmV0LzIwMTkvMTAvMTUvRXFZTm9iN1ZGOHRTZUdqLnBuZw.png"></p>
<p>如上图，三个部分使用“.”来进行连接。</p>
<h3 id="头部（header）"><a href="#头部（header）" class="headerlink" title="头部（header）"></a>头部（header）</h3><p>头部一般由 两个部分组成：token的类型 和 使用的算法。</p>
<p>形式如下：</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
    <span class="token property">"typ"</span><span class="token operator">:</span><span class="token string">"JWT"</span><span class="token punctuation">,</span>
	<span class="token property">"alg"</span><span class="token operator">:</span><span class="token string">"HS256"</span><span class="token punctuation">,</span>
    ...
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>除此之外,还可以有一些如zip（指示压缩方法）等自定义的字段。</p>
<h3 id="载荷（payload）"><a href="#载荷（payload）" class="headerlink" title="载荷（payload）"></a>载荷（payload）</h3><p>payload部分是JWT存储信息的部分，包含着Claims（声明），其实就是存储的的数据。</p>
<p>一般声明分为以下三种类型：</p>
<blockquote>
<ul>
<li>Registered claims：预定义的声明，如：<ul>
<li>iss：issuer 发布者的URL地址</li>
<li>sub：subject JWT面向的用户，不常用</li>
<li>aud：audience 接受者的URL地址</li>
<li>exp：expiration JWT失效的时间（Unix timestamp）</li>
<li>nbf：not before 该时间前JWT无效（Unix timestamp）</li>
<li>iat：issued at JWT发布时间（Unix timestamp）</li>
<li>jti：JWT ID</li>
</ul>
</li>
</ul>
</blockquote>
<p>当然上面的这些属性也不是必须都存在，可能存在一些其他信息，这些信息可以被提取，解析后可以起到传输数据作用。</p>
<pre class="line-numbers language-none"><code class="language-none">&#123;
    &quot;sub&quot;:&quot;456789123&quot;,
    &quot;name&quot;:&quot;Jack Ma&quot;,
    &quot;admin&quot;:false
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="签名（signature）"><a href="#签名（signature）" class="headerlink" title="签名（signature）"></a>签名（signature）</h3><p>有些文章将其译作”签证”。它的作用就是验证其是头部、载荷 是否被他人修改（JWT毕竟是Json文本，能被修改，从而导致不法分子伪冒操作）。</p>
<p>它的原理：</p>
<p><strong>将其头部、载荷两个部分内容进行Base64编码，随后加上秘匙，最后在依据头部中声明的加密方式进行加盐秘匙组合加密。</strong></p>
<p>比如：</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token function">HMACSHA256</span><span class="token punctuation">(</span><span class="token function">base64UrlEncode</span><span class="token punctuation">(</span>header<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"."</span> <span class="token operator">+</span> <span class="token function">base64UrlEncode</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">,</span> secret<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>这儿这个秘匙（secret） 就像是一把钥匙，生成 签名 就像是 用这把钥匙制作锁，而后面会谈到的JWT解密就像是用这把钥匙来开锁。</strong></p>
<h2 id="在JAVA中使用"><a href="#在JAVA中使用" class="headerlink" title="在JAVA中使用"></a>在JAVA中使用</h2><p>Java中目前最流行的JWT库就是<a target="_blank" rel="noopener" href="https://github.com/jwtk/jjwt">JJWT</a>。</p>
<p>使用JJWT需要导入3个依赖包:</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">></span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">></span></span>io<span class="token punctuation">.</span>jsonwebtoken<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">></span></span>jjwt<span class="token operator">-</span>api<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">></span></span><span class="token number">0.11</span><span class="token number">.2</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">></span>
<span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">></span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">></span></span>io<span class="token punctuation">.</span>jsonwebtoken<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">></span></span>jjwt<span class="token operator">-</span>impl<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">></span></span><span class="token number">0.11</span><span class="token number">.2</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>scope<span class="token punctuation">></span></span>runtime<span class="token operator">&lt;</span><span class="token operator">/</span>scope<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">></span>
<span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">></span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">></span></span>io<span class="token punctuation">.</span>jsonwebtoken<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">></span></span>jjwt<span class="token operator">-</span>jackson<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">></span> <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> or jjwt<span class="token operator">-</span>gson <span class="token keyword">if</span> <span class="token class-name">Gson</span> is preferred <span class="token operator">--</span><span class="token operator">></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">></span></span><span class="token number">0.11</span><span class="token number">.2</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>scope<span class="token punctuation">></span></span>runtime<span class="token operator">&lt;</span><span class="token operator">/</span>scope<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>当然如果你使用的是JDK10或者以下的老JDK版本的话,而且还需要使用 诸如RSASSA-PSS (PS256, PS384, PS512)算法的话,就需要在额外添加一个依赖包(JDK10以上的不需要):</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">></span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">></span></span>org<span class="token punctuation">.</span>bouncycastle<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">></span></span>bcprov<span class="token operator">-</span>jdk15on<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">></span></span><span class="token number">1.60</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>scope<span class="token punctuation">></span></span>runtime<span class="token operator">&lt;</span><span class="token operator">/</span>scope<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="使用JJWT创建一个JSON"><a href="#使用JJWT创建一个JSON" class="headerlink" title="使用JJWT创建一个JSON"></a>使用JJWT创建一个JSON</h3><p>创建一个Json大概分为3个部分:</p>
<ol>
<li><em>创建</em>一个含有默认载荷的JWT</li>
<li>用你的秘钥 <em>签名</em>（加密）这个JWT（秘钥必须满足HMAC-SHA-256算法）</li>
<li><em>打包</em>JWT，生成为一个字符串</li>
</ol>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">JwtBuilder</span> builder<span class="token operator">=</span> <span class="token class-name">Jwts</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span>   <span class="token comment">//设置唯一编号</span>
 <span class="token punctuation">.</span><span class="token function">setSubject</span><span class="token punctuation">(</span><span class="token string">"ZSSAER"</span><span class="token punctuation">)</span>  <span class="token comment">//设置主题  可以是JSON数据</span>
 <span class="token punctuation">.</span><span class="token function">setIssuedAt</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">//设置签发日期</span>
 <span class="token punctuation">.</span><span class="token function">signWith</span><span class="token punctuation">(</span><span class="token class-name">SignatureAlgorithm</span><span class="token punctuation">.</span>HS256<span class="token punctuation">,</span><span class="token string">"XXXXXXX"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//设置签名 使用HS256算法，并设置SecretKey(字符串)</span>
<span class="token comment">//构建 并返回一个字符串 </span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span> builder<span class="token punctuation">.</span><span class="token function">compact</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>其中“XXXXXXX”为你设置的密匙，接下来你需要使用它来进行解密。</p>
<p>一般来说，为了安全起见，JWT对其密匙是有相应的要求的，比如SHA-256加密的话，就需要256位的密匙，所以需要提前将其密匙进行SHA-256加密，这个操作可以使用JAVA或者去在线的SHA-256生成工具直接生成这个密匙。</p>
<p>前面说了，JWT中的荷载 中claims，除了想上面那样，一个一个set添加进去之外，还可以直接打包，它接受一个Map&lt;String,?&gt;的对象。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"sub"</span><span class="token punctuation">,</span> userDetails<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Jwts</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// 添加claims</span>
        <span class="token punctuation">.</span><span class="token function">setClaims</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span>
    	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>对于其map中的第一个String索引，我们可以前往Claims接口看：</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Claims</span> <span class="token keyword">extends</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span><span class="token punctuation">,</span> <span class="token class-name">ClaimsMutator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Claims</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span>

    <span class="token comment">/** JWT &#123;@code Issuer&#125; claims parameter name: &lt;code>"iss"&lt;/code> */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> ISSUER <span class="token operator">=</span> <span class="token string">"iss"</span><span class="token punctuation">;</span>

    <span class="token comment">/** JWT &#123;@code Subject&#125; claims parameter name: &lt;code>"sub"&lt;/code> */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> SUBJECT <span class="token operator">=</span> <span class="token string">"sub"</span><span class="token punctuation">;</span>

    <span class="token comment">/** JWT &#123;@code Audience&#125; claims parameter name: &lt;code>"aud"&lt;/code> */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> AUDIENCE <span class="token operator">=</span> <span class="token string">"aud"</span><span class="token punctuation">;</span>

    <span class="token comment">/** JWT &#123;@code Expiration&#125; claims parameter name: &lt;code>"exp"&lt;/code> */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> EXPIRATION <span class="token operator">=</span> <span class="token string">"exp"</span><span class="token punctuation">;</span>

    <span class="token comment">/** JWT &#123;@code Not Before&#125; claims parameter name: &lt;code>"nbf"&lt;/code> */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> NOT_BEFORE <span class="token operator">=</span> <span class="token string">"nbf"</span><span class="token punctuation">;</span>

    <span class="token comment">/** JWT &#123;@code Issued At&#125; claims parameter name: &lt;code>"iat"&lt;/code> */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> ISSUED_AT <span class="token operator">=</span> <span class="token string">"iat"</span><span class="token punctuation">;</span>

    <span class="token comment">/** JWT &#123;@code JWT ID&#125; claims parameter name: &lt;code>"jti"&lt;/code> */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> ID <span class="token operator">=</span> <span class="token string">"jti"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这些名称都在上面载荷介绍中说明了，只需要将其命名为对应的名称即可。</p>
<h3 id="使用JJWT解密JWT"><a href="#使用JJWT解密JWT" class="headerlink" title="使用JJWT解密JWT"></a>使用JJWT解密JWT</h3><p>有加密必然有解密。对于JWT解密而言，我们一般只在乎JWT中的荷载内容，就像我们收快递没人在乎快递包装，而是关心里面的产品，当然盒子收集控除外。</p>
<p>和登录操作一样，既然解密,就需要加密时的密匙，不然解密就不会成功。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 根据token获取body</span>
<span class="token class-name">Claims</span> claims<span class="token punctuation">;</span>
claims <span class="token operator">=</span> <span class="token class-name">Jwts</span><span class="token punctuation">.</span><span class="token function">parserBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// 设置密匙</span>
        <span class="token punctuation">.</span><span class="token function">setSigningKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// 解密的JWT</span>
        <span class="token punctuation">.</span><span class="token function">parseClaimsJws</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>通过getBody()方法，我们可以直接获取到荷载中的Claims，然后通过Claims我们便可以使用对应的Setting方法进行提取内容了。</p>
</div>

      <!-- Post Comments -->
      
    <!-- 使用 changyan -->
<div id="changyan-comment">
    <!--PC和WAP自适应版-->
<div id="SOHUCS" sid="2021/11/29/Jwt/"  ></div>
<script type="text/javascript">
(function(){
var appid = 'cyvzq2tmJ';
var conf = 'e61bcf9ca7baef66559e7e33e21fe290';
var width = window.innerWidth || document.documentElement.clientWidth;
if (width < 960) {
window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf + '"><\/script>'); } else { var loadJs=function(d,a){var c=document.getElementsByTagName("head")[0]||document.head||document.documentElement;var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("charset","UTF-8");b.setAttribute("src",d);if(typeof a==="function"){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e==="loaded"||e==="complete"){b.onreadystatechange=null;a()}}}else{b.onload=a}}c.appendChild(b)};loadJs("https://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:appid,conf:conf})}); } })(); </script>

</div>
<style>
    #changyan-comment{
        background-color: #eee;
        padding: 2pc;
    }
</style>

    </div>
    <!-- Copyright 版权 start -->
    <div id="copyright">
  <ul>
    <li>
      &copy;Powered By
      <a target="_blank" rel="noopener" href="https://hexo.io/" style="border-bottom: none">hexo</a>
    </li>
    <li>Author: <a style="border-bottom: none">@Zssaer</a></li>
  </ul>
  <ul>
    <li>
      <a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/" id="beian">蜀ICP备2021031070号</a>
    </li>
  </ul>
  
  <span id="busuanzi_container_site_pv"> 2024 </span>
  
</div>

  </div>
  <script>
    const originalTitle = document.title;
    document.title = `JWT快速上手教程` + `|` + originalTitle;
  </script>
</body>



 	
</html>
